<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: OAuth2Driver</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: OAuth2Driver</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>OAuth2Driver<span class="signature">()</span><span class="type-signature"></span></h2>
        
            <div class="class-description"><p>The <a href="OAuth2Driver.html">OAuth2Driver</a> class handles the OAuth2 pairing wizard if an oauth2ClientConfiguration is provided by
calling super.onInit(oauth2ClientConfiguration) or if Homey.app.oauth2ClientConfig is set to a valid
<a href="OAuth2Client.html">OAuth2Client</a> configuration. It will make sure Homey.app.OAuth2ClientManager exists and exposes the
<a href="OAuth2Client.html">OAuth2Client</a> associated with this driver via the oauth2Client property.</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="OAuth2Driver"><span class="type-signature"></span>new OAuth2Driver<span class="signature">()</span><span class="type-signature"></span></h4>
    

    















<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>

















    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const OAuth2Driver = require('homey-wifidriver').OAuth2Driver;
const ExampleAPI = require('example-api');

const oauth2ClientConfig = {
	url: `https://api.example.com/authorize?response_type=code&amp;client_id=${Homey.env.API_CLIENT_ID}&amp;redirect_uri=https://callback.athom.com/oauth2/callback/`,
	tokenEndpoint: 'https://api.example.com/token',
	key: Homey.env.API_CLIENT_ID,
	secret: Homey.env.API_CLIENT_SECRET,
	allowMultipleAccounts: false,
};

class myDriver extends OAuth2Driver { // Which extends WifiDriver

	onInit(){
		// This will override onPair() to handle OAuth2 pairing
		super.onInit({oauth2ClientConfig});
	}

	// This method will be called if a oauth2ClientConfig is provided onInit. The data object contains
	// an authenticated OAuth2Account instance which will be destroyed automatically after pairing
	// has ended.
	onPairOAuth2ListDevices(data) {

		// Create temporary API client with temporary account
		const exampleApiClient = new ExampleAPI({
			oauth2Account: data.oauth2Account,
		});

		// Return promise that fetches devices from account
		return exampleApiClient.fetchDevices()
			.then(devices => {
				exampleApiClient.destroy();
				return devices;
			})
		}
	}</code></pre>



    
    </div>

    
        <h3 class="subsection-title">Extends</h3>

        


    <ul>
        <li><a href="WifiDriver.html">WifiDriver</a></li>
    </ul>


    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="customOAuth2OnPair"><span class="type-signature"></span>customOAuth2OnPair<span class="signature">(socket)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>This method will be called when the user starts pairing a new device,
it executes a OAuth2 flow to retrieve devices linked to the users account.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>socket</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>


















        
            

    

    
    <h4 class="name" id="onInit"><span class="type-signature"></span>onInit<span class="signature">(options)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>This method needs to be called from a driver.onInit(), it will create an <a href="OAuth2Client.html">OAuth2Client</a>
and override the default onPair() method to handle the OAuth2 Flow.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>oauth2ClientConfig</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p><a href="OAuth2Client.html">OAuth2Client</a> configuration object</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>url</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>OAuth2 authorization url</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tokenEndpoint</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>OAuth2 token endpoint</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>OAuth2 client key</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>secret</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>OAuth2 client secret</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>allowMultipleAccounts</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>Specifies whether multiple accounts per
client are allowed</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>


















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="OAuth2Account.html">OAuth2Account</a></li><li><a href="OAuth2App.html">OAuth2App</a></li><li><a href="OAuth2Client.html">OAuth2Client</a></li><li><a href="OAuth2ClientManager.html">OAuth2ClientManager</a></li><li><a href="OAuth2Device.html">OAuth2Device</a></li><li><a href="OAuth2Driver.html">OAuth2Driver</a></li><li><a href="OAuth2Util.html">OAuth2Util</a></li><li><a href="WifiApp.html">WifiApp</a></li><li><a href="WifiDevice.html">WifiDevice</a></li><li><a href="WifiDriver.html">WifiDriver</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.1</a> on Wed Jul 12 2017 14:18:54 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>